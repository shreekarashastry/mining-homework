---
title: "ECO395M: Exercise 4"
author: "Steven Kim and Shreekara Shastry"
date: ""
output:
  md_document:
    variant: markdown_github
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, warning = FALSE, message = FALSE, cache = TRUE)
library(tidyverse)
library(knitr)
library(ggfortify)
library(foreach)
```

## Clustering and PCA

```{r}
wine = read.csv("wine.csv")
wine$color = wine$color %>% as.factor
wine1 = wine[,1:11]
PCAwine = prcomp(wine1, scale=TRUE, rank=3)

#plot(PCAwine)
#summary(PCAwine)
#round(PCAwine$rotation[,1:3],3) 

autoplot(PCAwine, data = wine, colour = 'color')
autoplot(PCAwine, data = wine, colour = 'quality', alpha = .9, 
         loadings = TRUE, loadings.colour = 'pink',
         loadings.label = TRUE, loadings.label.size = 3)

wine2 = scale(wine[,1:11]) # cluster on measurables k_grid = seq(2, 30, by=1)
N = nrow(wine2)
k_grid = seq(2, 30, by=1)
SSE_grid = foreach(k = k_grid, .combine='rbind') %do% {
cluster_k = kmeans(wine2, k, nstart=50)
W = cluster_k$tot.withinss
B = cluster_k$betweenss
CH = (B/W)*((N-k)/(k-1))
c(k=k, CH=CH)} %>% as.data.frame
ggplot(SSE_grid) +
  geom_line(aes(x=k, y=CH))
#choose k=10
Clusterwine = kmeans(wine2, 10, nstart=50)
qplot(quality, color, data=wine, color=factor(Clusterwine$cluster))
```

## Market Segmentation

```{r}
greenbuildings = read.csv("social_marketing.csv") %>% drop_na()
```

## Association rules for grocery purchase
```{r}

```